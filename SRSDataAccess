import java.io.*;
import java.util.*;
import fileChooser.*;

public class SRSDataAccess
{
  static File scheduleFileName = new File("SoC_AP2005.dat");
  static File facultyFileName = new File("Faculty.dat");
  static File assignmentsFileName = new File("TeachingAssignments.dat");
  static File courseFileName = new File("CourseCatalog.dat");
  static File prereqFileName = new File("Prerequisites.dat");
  static Scanner facultyScan, scheduleScan, assignmentsScan, courseScan, prereqScan, studentScan;
  static ScheduleOfClasses classes;
  
  
  
  
  
  
  /*
   * reads in data from faculty file and populates the faculty map
   */
  public static Faculty initializeFaculty()
  {
    Professor prof;
    Faculty faculty = new Faculty();
    try{
      Scanner assignmentsScan = new Scanner(assignmentsFileName);
      Scanner facultyScan = new Scanner(facultyFileName);
    }
    catch(FileNotFoundException exc)
    {
      exc.printStackTrace();
    }
    while (facultyScan.hasNextLine())
    {
      String line = facultyScan.nextLine();
      String[] array1 = line.split("/t");
      // new prof obj created with, name, ssn, title, dept
      prof = new Professor(array1[0],array1[1], array1[2], array1[3]);
      //adds prof to professors map in faculty class
      faculty.addProfessor(prof);
      
    }
    while(assignmentsScan.hasNextLine())
    {
      String line = assignmentsScan.nextLine();
      String[] array2 = line.split("/t");
      
      Professor p = faculty.findProfessor(array2[0]);
      String fullSecNo = array2[1];
      Section sex = classes.findSection(fullSecNo);
      p.agreeToTeach(sex);
    }
    assignmentsScan.close();
    facultyScan.close();
    return faculty;
  }
  
  
  
  //You fail as a teacher
  
  
  
  /*
   * reads data in from schedule file and populates schedule map
   */
  public static ScheduleOfClasses initializeScheduleOfClasses(String semester)
  {
    Section section;
    classes = new ScheduleOfClasses();
    try{
      Scanner scheduleScan = new Scanner(scheduleFileName);
    }
    catch(FileNotFoundException exc)
    {
      exc.printStackTrace();
    }
    classes.setSemester(semester);
    while (scheduleScan.hasNextLine())
    {
      String line = scheduleScan.nextLine();
      String[] array = line.split("/t");
      section = new Section(Integer.parseInt(array[1]), array[2], array[3], array[4], Integer.parseInt(array[5]));
      classes.addSection(array[0] + " - " + array[1], section);
    }
    scheduleScan.close();
    return classes;
  }
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  public static CourseCatalog initializeCourseCatalog()
  {
    Course course;
    CourseCatalog cat = new CourseCatalog();
    try{
      Scanner prereqScan = new Scanner(prereqFileName);
      Scanner courseScan = new Scanner(courseFileName);
    }
    catch(FileNotFoundException exc)
    {
      exc.printStackTrace();
    }
    while (scheduleScan.hasNextLine())
    {
      String line = scheduleScan.nextLine();
      String[] array = line.split("/t");
      course = new Course(array[0], array[1], Double.parseDouble(array[2]));
      cat.addCourse(course);
    }
    
    while(prereqScan.hasNextLine())
    {
      String line2 = prereqScan.nextLine();
      String[] array = line2.split("/t");
      String courseNo = array[1];
      String prereqNo = array[0];
      Course c = cat.findCourse(courseNo);
      Course p = cat.findCourse(prereqNo);
      if(!p.equals(null) && !c.equals(null))
      {
        c.addPrerequisite(p);
      }
      
    }
    
    prereqScan.close();
    courseScan.close();
    return cat;
  }
  
  
  
  
  
  public static Student initializeStudent(String ssn)
  {
    File studentFile = new File(ssn + ".dat");
    Section section;
    Student student;
    try
    {
      Scanner studentScan = new Scanner(studentFile);
    }
    catch(FileNotFoundException exc)
    {
     exc.printStackTrace(); 
    }
      String line = studentScan.nextLine();
      String array[] = line.split("/t");
      student = new Student(array[0],array[1],array[2],array[3]);
    
    
    while(studentScan.hasNextLine()){
      array =  studentScan.nextLine().split("/t");
      if(array[0] instanceof String){
        section = classes.findSection(array[0]);
        section.enroll(student);
      }
    }
    studentScan.close();
    return student;
  }
  
  /*
   * Saves student to its own ssn.dat file.
   * 
   * @param student Student to be saved to it's ssn.dat file.
   */
  public static void persistStudent(Student student) 
    throws FileNotFoundException{
    
    PrintWriter studentFile = new PrintWriter(student.getSsn() + ".dat");
    studentFile.print(student);
    studentFile.close();
  }
}
